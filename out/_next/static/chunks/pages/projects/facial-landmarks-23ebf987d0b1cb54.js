(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[345],{5037:function(e,a,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/projects/facial-landmarks",function(){return i(6419)}])},4091:function(e,a,i){"use strict";var t=i(5893),s=i(7294),n=i(7311),r=i(7951),l=i(6382),d=i(1924),o=i(8310),c=i(9538),m=i(9675);async function p(e){return(await (0,r.l)().use(l.Z,{fragment:!0}).use(d.Z).use(o.Z).use(c.Z).use(m.Z).process(e)).toString()}a.Z=e=>{let{htmlString:a,onRendered:i}=e,[r,l]=(0,s.useState)("");return(0,s.useEffect)(()=>{(async()=>{l(await p(a))})()},[a]),(0,s.useEffect)(()=>{r&&i&&i()},[r,i]),(0,t.jsx)("div",{children:(0,n.ZP)(r)})}},6493:function(e,a,i){"use strict";var t=i(5893);i(7294);var s=i(4091);a.Z=e=>{let{htmlString:a}=e;return(0,t.jsx)("div",{className:"project-content",children:(0,t.jsx)(s.Z,{htmlString:a})})}},6419:function(e,a,i){"use strict";i.r(a),i.d(a,{default:function(){return d}});var t=i(5893),s=i(1151);function n(e){let a={a:"a",h1:"h1",h2:"h2",img:"img",li:"li",p:"p",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.h1,{children:"Facial Landmarks"}),"\n",(0,t.jsxs)(a.p,{children:["Source Code: ",(0,t.jsx)(a.a,{href:"https://github.com/chaoyihu/real-time-facial-landmark",children:(0,t.jsx)(a.img,{src:"https://img.shields.io/static/v1?label=chaoyihu&message=real-time-facial-landmark&color=blue&logo=github",alt:"chaoyihu - real-time-facial-landmark"})})]}),"\n",(0,t.jsx)(a.h2,{children:"Highlights"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"Established a deep learning model with ResNet backbone using Pytorch, integrated with a MediaPipe facial detector,\nto predict coordinates of 68 keypoints on facial images."}),"\n",(0,t.jsx)(a.li,{children:"Developed a Python desktop application, using OpenCV, that runs real-time facial landmark predictions at above 20\nFPS on consumer devices using webcam inputs"}),"\n"]}),"\n",(0,t.jsx)(a.h2,{children:"Abstract"}),"\n",(0,t.jsx)(a.p,{children:"Synthetic human facial datasets offer many advantages such as controllable production and elimination of ethical concerns. In this project, we developed a facial landmarks model that trains on synthetic facial data and generalizes to real facial images."}),"\n",(0,t.jsx)(a.p,{children:"The network architecture we adopted consists of 68 layers featuring a Resnet backbone. For the selection of loss function, we conducted a pair of experiments showing that adopting wing loss reduced the prediction mean error (ME) and improved the prediction success rate (SR) by 7.8% compared to using MSE loss."}),"\n",(0,t.jsx)(a.p,{children:"We experimented with different portions of synthetic data in the training set. Trained with 100% synthetic data and tested on real images, the model achieved ME \xb1 Std = 23.69 \xb1 8.71 and SR = 0.41 (ME threshold = 20.0). When trained with 60% synthetic data and 40% real data, the performance improved to ME \xb1 Std = 18.64 \xb1 7.88 and SR = 0.60. However, decreasing the percentage of real data to 10% was shown to be detrimental to prediction accuracy."}),"\n",(0,t.jsx)(a.p,{children:"To evaluate the potential of the model inferencing on consumer devices in real time, we took special notes to the model size and inference speed. Experimenting with a trimmed network 23.6% smaller in size compared to the full version, we found that it inferences 23.1% faster at the cost of a 29.0% drop in SR, demonstrating a trade-off between model size and performance."}),"\n",(0,t.jsx)(a.p,{children:"Integrating the landmarks predictor with a face detector, we delivered a desktop demo that runs landmarks inferences in real-time on video inputs at approximately 20 FPS."}),"\n",(0,t.jsx)(a.h2,{children:"Detailed Presentation"}),"\n",(0,t.jsxs)(a.p,{children:[(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides1.jpg",alt:"Slide1"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides2.jpg",alt:"Slide2"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides3.jpg",alt:"Slide3"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides4.jpg",alt:"Slide4"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides5.jpg",alt:"Slide5"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides6.jpg",alt:"Slide6"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides7.jpg",alt:"Slide7"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides8.jpg",alt:"Slide8"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides9.jpg",alt:"Slide9"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides10.jpg",alt:"Slide10"})]}),"\n",(0,t.jsx)("img",{src:"/images/projects/facial-landmarks/slides10_gif1.gif",width:"400"}),"\n",(0,t.jsx)("img",{src:"/images/projects/facial-landmarks/slides10_gif2.gif",width:"400"}),"\n",(0,t.jsxs)(a.p,{children:[(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides11.jpg",alt:"Slide11"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides12.jpg",alt:"Slide12"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides13.jpg",alt:"Slide13"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides14.jpg",alt:"Slide14"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides15.jpg",alt:"Slide15"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides16.jpg",alt:"Slide16"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides17.jpg",alt:"Slide17"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides18.jpg",alt:"Slide18"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides19.jpg",alt:"Slide19"}),"\n",(0,t.jsx)(a.img,{src:"/images/projects/facial-landmarks/slides20.jpg",alt:"Slide20"})]}),"\n",(0,t.jsx)(a.h2,{children:"Conclusion and Prospects"}),"\n",(0,t.jsx)(a.p,{children:"In this project, we conducted experiments to train a facial landmarks model using synthetic facial data and evaluate its ability to generalize to real facial images. We employed a lightweight convolutional network architecture featuring ResNet backbone and wing loss for training. The choice of loss function was made based on experiment results showing that adoption of wing loss improved the prediction SR by 7.8%. Our results suggest that trained with 100% synthetic data, the model achieved ME \xb1 Std = 23.69 \xb1 8.71 and SR = 0.41 (ME threshold = 20.0) on real test images. The performance improved to ME \xb1 Std = 18.64 \xb1 7.88 and SR = 0.60 when trained with 60% synthetic data and 40% real data, and dropped significantly when the percentage of real data was further decreased to 10%. The results indicates that for the data mixing approach, a proper mixture of synthetic and real data in the training set might help improve the model performance compared to training with purely synthetic data. We further explored the impact of model size on its performance. A trimmed network 23.6% smaller in size compared to the full version inferences 23.1% faster at the cost of a 29.0% drop in SR. Results suggest a trade-off relationship between model inference speed and its prediction accuracy. Employing the landmarks model trained in this project integrated with a facial detection module, we developed a desktop demo that runs landmarks inferences in real-time on webcam capture or video inputs at approximately 20 FPS."}),"\n",(0,t.jsx)(a.p,{children:"Overall, we have fulfilled our project design in the project proposal with additional experiments on data mixing in the training set and comparison between MSE and wing loss functions. The prediction accuracy of our models cannot match state-of-the-art landmarks localization models, yet our results did provide some revelations subject to further exploration."})]})}var r=i(6493);let l=i(7762).renderToString((0,t.jsx)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:a}={...(0,s.a)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(n,{...e})}):n(e)},{}));function d(){return(0,t.jsx)(r.Z,{htmlString:l})}}},function(e){e.O(0,[774,644,888,179],function(){return e(e.s=5037)}),_N_E=e.O()}]);